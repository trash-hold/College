Old rough version of code 
